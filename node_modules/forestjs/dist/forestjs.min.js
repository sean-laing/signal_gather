!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("stream"),require("util"),require("buffer"),require("querystring"),require("http"),require("https"),require("url"),require("events"),require("string_decoder")):"function"==typeof define&&define.amd?define(["stream","util","buffer","querystring","http","https","url","events","string_decoder"],t):"object"==typeof exports?exports.forestjs=t(require("stream"),require("util"),require("buffer"),require("querystring"),require("http"),require("https"),require("url"),require("events"),require("string_decoder")):e.forestjs=t(e.stream,e.util,e.buffer,e.querystring,e.http,e.https,e.url,e.events,e.string_decoder)}(this,function(e,t,n,r,i,o,a,s,u){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),o=r(i),a=n(19),s=r(a);t.default={DecisionTree:o.default,RandomForest:s.default},e.exports=t.default},function(e,t){e.exports=require("stream")},function(e,t){e.exports=require("util")},function(e,t,n){function r(e){return this instanceof r?(u.call(this,e),c.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new r(e)}function i(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}function o(e,t){for(var n=0,r=e.length;r>n;n++)t(e[n],n)}e.exports=r;var a=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},s=n(4);s.inherits=n(5);var u=n(11),c=n(13);s.inherits(r,u),o(a(c.prototype),function(e){r.prototype[e]||(r.prototype[e]=c.prototype[e])})},function(e,t){function n(e){return Array.isArray(e)}function r(e){return"boolean"==typeof e}function i(e){return null===e}function o(e){return null==e}function a(e){return"number"==typeof e}function s(e){return"string"==typeof e}function u(e){return"symbol"==typeof e}function c(e){return void 0===e}function l(e){return d(e)&&"[object RegExp]"===v(e)}function d(e){return"object"==typeof e&&null!==e}function f(e){return d(e)&&"[object Date]"===v(e)}function h(e){return d(e)&&("[object Error]"===v(e)||e instanceof Error)}function p(e){return"function"==typeof e}function m(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function g(e){return Buffer.isBuffer(e)}function v(e){return Object.prototype.toString.call(e)}t.isArray=n,t.isBoolean=r,t.isNull=i,t.isNullOrUndefined=o,t.isNumber=a,t.isString=s,t.isSymbol=u,t.isUndefined=c,t.isRegExp=l,t.isObject=d,t.isDate=f,t.isError=h,t.isFunction=p,t.isPrimitive=m,t.isBuffer=g},function(e,t,n){e.exports=n(2).inherits},function(e,t,n){function r(e,t){var n=Array.prototype.slice.call(arguments,2);return function(){var r=n.concat(Array.prototype.slice.call(arguments));return t.apply(e,r)}}function i(e,t,n,i){"object"==typeof e&&(n=t,t=e,e=void 0),"function"==typeof t&&(n=t,t=void 0),t||(t={}),void 0!==e&&(t.uri=e),i&&(t.method=i.method);var a=new o(t),s=a.duplex&&c();s&&s.pause();var u=c(),d=a.duplex?l(s,u):u;a.duplex||(u.writable=!1),d.request=a,d.setHeader=r(a,a.setHeader),d.setLocation=r(a,a.setLocation);var f=!1;return d.on("close",function(){f=!0}),process.nextTick(function(){if(!f){d.on("close",function(){e.destroy()});var e=a._send();e.on("error",r(d,d.emit,"error")),e.on("response",function(e){d.response=e,d.emit("response",e),a.duplex?e.pipe(u):(e.on("data",function(e){u.queue(e)}),e.on("end",function(){u.queue(null)}))}),a.duplex?(s.pipe(e),s.resume()):e.end()}}),n&&(d.on("error",n),d.on("response",r(d,n,null))),d}function o(e){this.headers=e.headers||{};var t=(e.method||"GET").toUpperCase();this.method=t,this.duplex=!("GET"===t||"DELETE"===t||"HEAD"===t),this.auth=e.auth,this.options=e,e.uri&&this.setLocation(e.uri)}var a=n(18),s=n(16),u=n(17),c=n(32),l=n(31);e.exports=i,i.get=i,i.post=function(e,t,n){return i(e,t,n,{method:"POST"})},i.put=function(e,t,n){return i(e,t,n,{method:"PUT"})},i.delete=function(e,t,n){return i(e,t,n,{method:"DELETE"})},o.prototype._send=function(){this._sent=!0;var e=this.headers||{},t=a.parse(this.uri),n=t.auth||this.auth;n&&(e.authorization="Basic "+Buffer(n).toString("base64"));var r=t.protocol||"",i="https:"===r?u:s,o={scheme:r.replace(/:$/,""),method:this.method,host:t.hostname,port:Number(t.port)||("https:"===r?443:80),path:t.path,agent:!1,headers:e,withCredentials:this.options.withCredentials};"https:"===r&&(o.pfx=this.options.pfx,o.key=this.options.key,o.cert=this.options.cert,o.ca=this.options.ca,o.ciphers=this.options.ciphers,o.rejectUnauthorized=this.options.rejectUnauthorized,o.secureProtocol=this.options.secureProtocol);var c=i.request(o);return c.setTimeout&&c.setTimeout(1e3*Math.pow(2,32)),c},o.prototype.setHeader=function(e,t){if(this._sent)throw new Error("request already sent");return this.headers[e]=t,this},o.prototype.setLocation=function(e){return this.uri=e,this}},function(e,t,n){t.Stringifier=n(34),t.Parser=n(33)},function(e,t){e.exports=require("buffer")},function(e,t){e.exports=require("querystring")},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t,n){for(var r=void 0===arguments[3]?{}:arguments[3],i=r.numTries||10,o=c(0,e[0].length),a=n.length,u=s(t,n),l=0,d=0,f=0;i>f;f++){for(var h=n[c(0,a)],p=n[c(0,a)];p==h;)p=n[c(0,a)];for(var m=Math.random(),g=e[h][o]*m+e[p][o]*(1-m),v=1,b=1,w=1,y=1,x=0;x<n.length;x++)e[n[x]][o]<g?1==t[n[x]]?v++:w++:1==t[n[x]]?b++:y++;var S=v+w;v/=S,w/=S,S=b+y,b/=S,y/=S;var k=-v*Math.log(v)-w*Math.log(w),_=-b*Math.log(b)-y*Math.log(y),T=u-k-_;(T>l||0===f)&&(l=T,d=g)}return{ri:o,thr:d}}function i(e,t){return t?e[t.ri]<t.thr?1:-1:1}function o(e,t,n){var r=void 0===arguments[3]?{}:arguments[3],i=r.numTries||10,o=n.length,a=0,l=1;if(e[0].length>2)for(a=c(0,e[0].length),l=c(0,e[0].length);l==a;)l=c(0,e[0].length);for(var d,f,h,p=s(t,n),m=0,g=new Array(n.length),v=0;i>v;v++){for(var b=u(0,2*Math.PI),w=Math.cos(b),y=Math.sin(b),x=0;x<n.length;x++)g[x]=w*e[n[x]][a]+y*e[n[x]][l];for(var S=n[c(0,o)],k=n[c(0,o)];k==S;)k=n[c(0,o)];for(var _=Math.random(),T=g[S]*_+g[k]*(1-_),j=1,M=1,E=1,R=1,x=0;x<n.length;x++)g[x]<T?1==t[n[x]]?j++:E++:1==t[n[x]]?M++:R++;var C=j+E;j/=C,E/=C,C=M+R,M/=C,R/=C;var N=-j*Math.log(j)-E*Math.log(E),D=-M*Math.log(M)-R*Math.log(R),O=p-N-D;(O>m||0===v)&&(m=O,d=w,f=y,h=T)}return{w1:d,w2:f,dotthr:h}}function a(e,t){return t?e[0]*t.w1+e[1]*t.w2<t.dotthr?1:-1:1}function s(e,t){for(var n=t.length,r=0,i=0;n>i;i++)1==e[t[i]]&&(r+=1);r=(1+r)/(n+2);var o=(1+n-r)/(n+2);return-r*Math.log(r)-o*Math.log(o)}function u(e,t){return Math.random()*(t-e)+e}function c(e,t){return Math.floor(Math.random()*(t-e)+e)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=function(){function e(){var t=void 0===arguments[0]?{}:arguments[0];n(this,e),"string"==typeof t&&(t=JSON.parse(t));var s=!0,u=!1,c=void 0;try{for(var l,d=Object.keys(t)[Symbol.iterator]();!(s=(l=d.next()).done);s=!0){var f=l.value;this[f]=t[f]}}catch(h){u=!0,c=h}finally{try{!s&&d.return&&d.return()}finally{if(u)throw c}}this.trainFun||(this.trainFun=0===this.weakType?r:o),this.testFun||(this.testFun=0===this.weakType?i:a)}return l(e,[{key:"train",value:function(e,t){var n=void 0===arguments[2]?{}:arguments[2],s=n.maxDepth||4,u=n.type||0,c=n.trainFun||o,l=n.testFun||a;0==u&&(c=r,l=i),1==u&&(c=o,l=a);for(var d=Math.pow(2,s)-1,f=Math.pow(2,s+1)-1,h=new Array(f),p=1;p<h.length;p++)h[p]=[];h[0]=new Array(t.length);for(var p=0;p<t.length;p++)h[0][p]=p;for(var m=new Array(d),g=0;d>g;g++){var v=h[g];if(0!=v.length)if(1!=v.length){var b=c(e,t,v);m[g]=b;for(var w=[],y=[],p=0;p<v.length;p++){var x=l(e[v[p]],b);1===x?w.push(v[p]):y.push(v[p])}h[2*g+1]=w,h[2*g+2]=y}else h[2*g+1]=[v[0]]}for(var S=new Array(f),k=new Array(f),g=d;f>g;g++){for(var _=0,p=0;p<h[g].length;p++)1===t[h[g][p]]&&(_+=1);S[g]=_,k[g]=h[g].length-_}this.models=m,this.leafPositives=S,this.leafNegatives=k,this.maxDepth=s,this.weakType=u,this.trainFun=c,this.testFun=l}},{key:"predictOne",value:function(e){for(var t=0,n=0;n<this.maxDepth;n++){var r=this.testFun(e,this.models[t]);t=1===r?2*t+1:2*t+2}return(this.leafPositives[t]+.5)/(this.leafNegatives[t]+1)}}]),e}();t.default=d,e.exports=t.default},function(e,t,n){function r(e,t){var r=n(3);e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,t instanceof r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(E||(E=n(14).StringDecoder),this.decoder=new E(e.encoding),this.encoding=e.encoding)}function i(e){n(3);return this instanceof i?(this._readableState=new r(e,this),this.readable=!0,void j.call(this)):new i(e)}function o(e,t,n,r,i){var o=c(t,n);if(o)e.emit("error",o);else if(M.isNullOrUndefined(n))t.reading=!1,t.ended||l(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var s=new Error("stream.push() after EOF");e.emit("error",s)}else if(t.endEmitted&&i){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else!t.decoder||i||r||(n=t.decoder.write(n)),i||(t.reading=!1),t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&d(e)),h(e,t);else i||(t.reading=!1);return a(t)}function a(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function s(e){if(e>=C)e=C;else{e--;for(var t=1;32>t;t<<=1)e|=e>>t;e++}return e}function u(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:isNaN(e)||M.isNull(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:0>=e?0:(e>t.highWaterMark&&(t.highWaterMark=s(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function c(e,t){var n=null;return M.isBuffer(t)||M.isString(t)||M.isNullOrUndefined(t)||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function l(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,d(e)}function d(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(R("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?process.nextTick(function(){f(e)}):f(e))}function f(e){R("emit readable"),e.emit("readable"),b(e)}function h(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(function(){p(e,t)}))}function p(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(R("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function m(e){return function(){var t=e._readableState;R("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&T.listenerCount(e,"data")&&(t.flowing=!0,b(e))}}function g(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(function(){v(e,t)}))}function v(e,t){t.resumeScheduled=!1,e.emit("resume"),b(e),t.flowing&&!t.reading&&e.read(0)}function b(e){var t=e._readableState;if(R("flow",t.flowing),t.flowing)do var n=e.read();while(null!==n&&t.flowing)}function w(e,t){var n,r=t.buffer,i=t.length,o=!!t.decoder,a=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(a)n=r.shift();else if(!e||e>=i)n=o?r.join(""):_.concat(r,i),r.length=0;else if(e<r[0].length){var s=r[0];n=s.slice(0,e),r[0]=s.slice(e)}else if(e===r[0].length)n=r.shift();else{n=o?"":new _(e);for(var u=0,c=0,l=r.length;l>c&&e>u;c++){var s=r[0],d=Math.min(e-u,s.length);o?n+=s.slice(0,d):s.copy(n,u,0,d),d<s.length?r[0]=s.slice(d):r.shift(),u+=d}}return n}function y(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");t.endEmitted||(t.ended=!0,process.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function x(e,t){for(var n=0,r=e.length;r>n;n++)t(e[n],n)}function S(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1}e.exports=i;var k=n(38),_=n(8).Buffer;i.ReadableState=r;var T=n(40).EventEmitter;T.listenerCount||(T.listenerCount=function(e,t){return e.listeners(t).length});var j=n(1),M=n(4);M.inherits=n(5);var E,R=n(2);R=R&&R.debuglog?R.debuglog("stream"):function(){},M.inherits(i,j),i.prototype.push=function(e,t){var n=this._readableState;return M.isString(e)&&!n.objectMode&&(t=t||n.defaultEncoding,t!==n.encoding&&(e=new _(e,t),t="")),o(this,n,e,t,!1)},i.prototype.unshift=function(e){var t=this._readableState;return o(this,t,e,"",!0)},i.prototype.setEncoding=function(e){return E||(E=n(14).StringDecoder),this._readableState.decoder=new E(e),this._readableState.encoding=e,this};var C=8388608;i.prototype.read=function(e){R("read",e);var t=this._readableState,n=e;if((!M.isNumber(e)||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return R("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?y(this):d(this),null;if(e=u(e,t),0===e&&t.ended)return 0===t.length&&y(this),null;var r=t.needReadable;R("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,R("length less than watermark",r)),(t.ended||t.reading)&&(r=!1,R("reading or ended",r)),r&&(R("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),r&&!t.reading&&(e=u(n,t));var i;return i=e>0?w(e,t):null,M.isNull(i)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),n!==e&&t.ended&&0===t.length&&y(this),M.isNull(i)||this.emit("data",i),i},i.prototype._read=function(e){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(e,t){function n(e){R("onunpipe"),e===l&&i()}function r(){R("onend"),e.end()}function i(){R("cleanup"),e.removeListener("close",s),e.removeListener("finish",u),e.removeListener("drain",p),e.removeListener("error",a),e.removeListener("unpipe",n),l.removeListener("end",r),l.removeListener("end",i),l.removeListener("data",o),!d.awaitDrain||e._writableState&&!e._writableState.needDrain||p()}function o(t){R("ondata");var n=e.write(t);!1===n&&(R("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++,l.pause())}function a(t){R("onerror",t),c(),e.removeListener("error",a),0===T.listenerCount(e,"error")&&e.emit("error",t)}function s(){e.removeListener("finish",u),c()}function u(){R("onfinish"),e.removeListener("close",s),c()}function c(){R("unpipe"),l.unpipe(e)}var l=this,d=this._readableState;switch(d.pipesCount){case 0:d.pipes=e;break;case 1:d.pipes=[d.pipes,e];break;default:d.pipes.push(e)}d.pipesCount+=1,R("pipe count=%d opts=%j",d.pipesCount,t);var f=(!t||t.end!==!1)&&e!==process.stdout&&e!==process.stderr,h=f?r:i;d.endEmitted?process.nextTick(h):l.once("end",h),e.on("unpipe",n);var p=m(l);return e.on("drain",p),l.on("data",o),e._events&&e._events.error?k(e._events.error)?e._events.error.unshift(a):e._events.error=[a,e._events.error]:e.on("error",a),e.once("close",s),e.once("finish",u),e.emit("pipe",l),d.flowing||(R("pipe resume"),l.resume()),e},i.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;r>i;i++)n[i].emit("unpipe",this);return this}var i=S(t.pipes,e);return-1===i?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},i.prototype.on=function(e,t){var n=j.prototype.on.call(this,e,t);if("data"===e&&!1!==this._readableState.flowing&&this.resume(),"readable"===e&&this.readable){var r=this._readableState;if(!r.readableListening)if(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading)r.length&&d(this,r);else{var i=this;process.nextTick(function(){R("readable nexttick read 0"),i.read(0)})}}return n},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){var e=this._readableState;return e.flowing||(R("resume"),e.flowing=!0,e.reading||(R("resume read 0"),this.read(0)),g(this,e)),this},i.prototype.pause=function(){return R("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(R("pause"),this._readableState.flowing=!1,this.emit("pause")),this},i.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(R("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(R("wrapped data"),t.decoder&&(i=t.decoder.write(i)),i&&(t.objectMode||i.length)){var o=r.push(i);o||(n=!0,e.pause())}});for(var i in e)M.isFunction(e[i])&&M.isUndefined(this[i])&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return x(o,function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){R("wrapped _read",t),n&&(n=!1,e.resume())},r},i._fromList=w},function(e,t,n){function r(e,t){this.afterTransform=function(e,n){return i(t,e,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function i(e,t,n){var r=e._transformState;r.transforming=!1;var i=r.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,u.isNullOrUndefined(n)||e.push(n),i&&i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);s.call(this,e),this._transformState=new r(e,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){u.isFunction(this._flush)?this._flush(function(e){a(t,e)}):a(t)})}function a(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=e._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}e.exports=o;var s=n(3),u=n(4);u.inherits=n(5),u.inherits(o,s),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,s.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;u.isNull(t.writechunk)||!t.writecb||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))}},function(e,t,n){function r(e,t,n){this.chunk=e,this.encoding=t,this.callback=n}function i(e,t){var r=n(3);e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.objectMode=!!e.objectMode,t instanceof r&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var a=e.decodeStrings===!1;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){h(t,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function o(e){var t=n(3);return this instanceof o||this instanceof t?(this._writableState=new i(e,this),this.writable=!0,void k.call(this)):new o(e)}function a(e,t,n){var r=new Error("write after end");e.emit("error",r),process.nextTick(function(){n(r)})}function s(e,t,n,r){var i=!0;if(!(S.isBuffer(n)||S.isString(n)||S.isNullOrUndefined(n)||t.objectMode)){var o=new TypeError("Invalid non-string/buffer chunk");e.emit("error",o),process.nextTick(function(){r(o)}),i=!1}return i}function u(e,t,n){return!e.objectMode&&e.decodeStrings!==!1&&S.isString(t)&&(t=new x(t,n)),t}function c(e,t,n,i,o){n=u(t,n,i),S.isBuffer(n)&&(i="buffer");var a=t.objectMode?1:n.length;t.length+=a;var s=t.length<t.highWaterMark;return s||(t.needDrain=!0),t.writing||t.corked?t.buffer.push(new r(n,i,o)):l(e,t,!1,a,n,i,o),s}function l(e,t,n,r,i,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function d(e,t,n,r,i){n?process.nextTick(function(){t.pendingcb--,i(r)}):(t.pendingcb--,i(r)),e._writableState.errorEmitted=!0,e.emit("error",r)}function f(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function h(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(f(n),t)d(e,n,r,t,i);else{var o=v(e,n);o||n.corked||n.bufferProcessing||!n.buffer.length||g(e,n),r?process.nextTick(function(){p(e,n,o,i)}):p(e,n,o,i)}}function p(e,t,n,r){n||m(e,t),t.pendingcb--,r(),w(e,t)}function m(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function g(e,t){if(t.bufferProcessing=!0,e._writev&&t.buffer.length>1){for(var n=[],r=0;r<t.buffer.length;r++)n.push(t.buffer[r].callback);t.pendingcb++,l(e,t,!0,t.length,t.buffer,"",function(e){for(var r=0;r<n.length;r++)t.pendingcb--,n[r](e)}),t.buffer=[]}else{for(var r=0;r<t.buffer.length;r++){var i=t.buffer[r],o=i.chunk,a=i.encoding,s=i.callback,u=t.objectMode?1:o.length;if(l(e,t,!1,u,o,a,s),t.writing){r++;break}}r<t.buffer.length?t.buffer=t.buffer.slice(r):t.buffer.length=0}t.bufferProcessing=!1}function v(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function b(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function w(e,t){var n=v(e,t);return n&&(0===t.pendingcb?(b(e,t),t.finished=!0,e.emit("finish")):b(e,t)),n}function y(e,t,n){t.ending=!0,w(e,t),n&&(t.finished?process.nextTick(n):e.once("finish",n)),t.ended=!0}e.exports=o;var x=n(8).Buffer;o.WritableState=i;var S=n(4);S.inherits=n(5);var k=n(1);S.inherits(o,k),o.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},o.prototype.write=function(e,t,n){var r=this._writableState,i=!1;return S.isFunction(t)&&(n=t,t=null),S.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),S.isFunction(n)||(n=function(){}),r.ended?a(this,r,n):s(this,r,e,n)&&(r.pendingcb++,i=c(this,r,e,t,n)),i},o.prototype.cork=function(){var e=this._writableState;e.corked++},o.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.buffer.length||g(this,e))},o.prototype._write=function(e,t,n){n(new Error("not implemented"))},o.prototype._writev=null,o.prototype.end=function(e,t,n){var r=this._writableState;S.isFunction(e)?(n=e,e=null,t=null):S.isFunction(t)&&(n=t,t=null),S.isNullOrUndefined(e)||this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||y(this,r,n)}},function(e,t,n){function r(e){if(e&&!u(e))throw new Error("Unknown encoding: "+e)}function i(e){return e.toString(this.encoding)}function o(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function a(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var s=n(8).Buffer,u=s.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},c=t.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),r(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=a;break;default:return void(this.write=i)}this.charBuffer=new s(6),this.charReceived=0,this.charLength=0};c.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";e=e.slice(n,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=t.charCodeAt(t.length-1);if(!(r>=55296&&56319>=r)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i);var i=t.length-1,r=t.charCodeAt(i);if(r>=55296&&56319>=r){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,i)}return t},c.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(2>=t&&n>>4==14){this.charLength=3;break}if(3>=t&&n>>3==30){this.charLength=4;break}}this.charReceived=t},c.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;t+=r.slice(0,n).toString(i)}return t}},function(e,t,n){t=e.exports=n(11),t.Stream=n(1),t.Readable=t,t.Writable=n(13),t.Duplex=n(3),t.Transform=n(12),t.PassThrough=n(37)},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("https")},function(e,t){e.exports=require("url")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(20),s=r(a),u=n(10),c=r(u),l=n(39),d=r(l),f=function(){function e(){i(this,e)}return o(e,[{key:"train",value:function(e,t){var n=void 0===arguments[2]?{}:arguments[2];this.numTrees=n.numTrees||100,this.trees=new Array(this.numTrees);for(var r=0;r<this.numTrees;r++)this.trees[r]=new c.default,this.trees[r].train(e,t,n)}},{key:"trainCRP",value:function(e,t){var n=this,r=void 0===arguments[2]?{}:arguments[2];if(this.numTrees=r.numTrees||100,r.url="https://api.crowdprocess.com:443",!r.token&&!r.email||!r.password)throw new Error("Missing credentials!");var i=JSON.stringify({data:e,labels:t,options:r});return s.default(r)(Array.apply(null,new Array(this.numTrees)).map(function(){return i}),[d.default,function(e){var t=JSON.parse(e),n=t.data,r=t.labels,i=t.options,o=new c.default;return o.train(n,r,i),JSON.stringify(o)}].map(function(e){return e.toString()}).join("\n").replace(/_DecisionTree2\['default'\]/g,"DecisionTree"),function(e){return n.trees=e.map(function(e){return new c.default(e)})}).on("error",console.error.bind(console))}},{key:"predictOne",value:function(e){for(var t=0,n=this.trees.length,r=0;n>r;r++)t+=this.trees[r].predictOne(e);return t/n}},{key:"predict",value:function(e){for(var t=new Array(e.length),n=0;n<e.length;n++)t[n]=this.predictOne(e[n]);return t}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){function r(e,t){function n(e,t,r){function o(e,t){if(e)return void a.emit("error",e);if(!a.opts.mock){var n=t.id;a.opts.id||a.emit("created",n),a.resultStream=p(n).Results({stream:!0}),a.errorStream=p(n).Errors({stream:!0}),a.taskStream=p(n).Tasks(),a.inRStream.pipe(a.taskStream),a.resultStream.pipe(a.outWStream),a.errorStream.on("data",function(e){a.numResults++,a.emit("error",e),a._maybeClose()})}if(a.opts.data instanceof i&&(a.opts.data.pipe(a),a.opts.data.on("end",function(){a.inRStream.end(),a.end()})),a.opts.data instanceof Array){for(var r=a.opts.data,o=r.length,s=0;o>s;s++)a.numTasks++,null===r[s]?a.inRStream.write(0):a.inRStream.write(r[s]);a.inRStream.end(),a.end()}if(a.opts.onResults&&a.on("data",function(e){a.bufferedResults.push(e)}),a.outWStream.on("readable",function(){a._read(0)}),a.outWStream.on("end",function(){a.push(null)}),a.opts.mock){var u=a.opts.program;if("string"==typeof u)throw new Error("In mock mode, your program has to be a function.");a.inRStream.on("data",function(e){function t(e){process.nextTick(function(){a.outWStream.write(e)})}var n;2===u.length?u(e,t):(n=u(e),t(n))})}}if(!(this instanceof n))return new n(e,t,r);var a=this,s={};e instanceof Object&&Object.getPrototypeOf(e)===Object.prototype&&(s=e),(e instanceof i||e instanceof Array)&&(s.data=e),e instanceof Function&&(s.program=e.toString()),"string"==typeof e&&(s.program=e),Buffer.isBuffer(e)&&(s.program=e.toString()),!s.program&&(t instanceof Function||"string"==typeof t||Buffer.isBuffer(t))&&(s.program=t),!s.mock&&s.program instanceof Function&&(s.program=s.program.toString()),Buffer.isBuffer(s.program)&&(s.program=s.program.toString()),s.program&&!s.data&&t instanceof Function&&(s.onResults=t),r instanceof Function&&(s.onResults=r),s.objectMode=!0,u.call(this,s),this.opts=s,this.inRStream=new c(s),this.outWStream=new c(s),this.numTasks=0,this.numResults=0,this.bufferedResults=[],this.on("pipe",function(e){e.on("end",function(){a.inRStream.end()})}),this.on("end",function(){a.inRStream.end()}),s.id?process.nextTick(function(){o(null,{id:s.id})}):s.mock?process.nextTick(o):h.create({program:s.program,group:s.group,bid:s.bid},o)}function r(e,t,n){var r=this;r.numTasks++,r.inRStream.write(e)?(n(),r._maybeClose()):r.inRStream.once("drain",n)}function l(e){for(var t=this;null!==(chunk=t.outWStream.read())&&(t.numResults++,t.push(chunk));)t._maybeClose()}function d(){var e=this;e.ended||e._writableState.ended&&e.numResults==e.numTasks&&(e.ended=!0,e.opts.mock||(e.resultStream.end(),e.errorStream.end()),e.inRStream.end(),e.push(null),e.opts.onResults&&e.opts.onResults(e.bufferedResults))}var f={};1===arguments.length&&"string"==typeof arguments[0]&&(f.token=arguments[0]),1===arguments.length&&"object"==typeof arguments[0]&&(f=arguments[0]),2===arguments.length&&"string"==typeof arguments[0]&&"string"==typeof arguments[1]&&(f.email=arguments[0],f.password=arguments[1]);var h=o(f),p=a(f);return s(n,u),n.prototype._write=r,n.prototype._read=l,n.prototype._maybeClose=d,n.map=n,n}var i=n(1),o=n(22),a=n(30),s=n(2).inherits,u=i.Duplex||n(15).Duplex,c=i.PassThrough||n(15).PassThrough;e.exports=r},function(e,t,n){t.server={url:"https://api.crowdprocess.com:443"}},function(e,t,n){function r(e,t,n){return function(r){var i=s({uri:e.url+"/jobs/"+n},t),u=o.get(i,function(e,t){if(e)throw new Error(e);return 200!==t.statusCode?(e=new Error("Response status code is "+t.statusCode),e.status=t.statusCode,r(e)):void a(u,function(e,t){if(e)throw new Error(e);r(e,JSON.parse(t.toString()))})})}}function i(e,t,n){return function(r){var i=s({uri:e.url+"/jobs/"+n,method:"DELETE"},t),a=o(i,function(e,t){if(e)throw new Error(e);return 204!==t.statusCode?(e=new Error("Response status code is "+t.statusCode),e.status=a.statusCode,r(e)):void r(null)})}}var o=n(24),a=n(27),s=n(23),u=n(21),c={url:u.server.url};t=e.exports=function(e){function t(t){return{show:r(e,f,t),destroy:i(e,f,t)}}function n(t,n){var r=s({uri:e.url+"/jobs"},f),i=o.post(r,function(e,t){if(e)throw new Error(e);return 201!==t.statusCode?(e=new Error("Response status code is "+t.statusCode),
e.status=t.statusCode,n(e)):void a(i,function(e,t){if(e)throw new Error(e);n(e,JSON.parse(t.toString()))})});i.write(JSON.stringify(t)),i.end()}function u(t){var n=s({uri:e.url+"/jobs"},f),r=o.get(n,function(e,n){return e?t(e):200!==n.statusCode?(e=new Error("Response status code is "+n.statusCode),e.status=n.statusCode,t(e)):void a(r,function(e,n){if(e)throw new Error(e);t(null,JSON.parse(n.toString()))})})}function l(){var t=s({uri:e.url+"/jobs?stream=true"},f),n=o.get(t);return n}function d(t){var n=s({uri:e.url+"/jobs",method:"DELETE"},f);o.del(n,function(e,n){if(e)throw new Error(e);return 204!=n.statusCode?(e=new Error("Response status code is "+n.statusCode),e.status=n.statusCode,t(e)):void t(null)})}e||(e={}),e=s(s({},c),e);var f={headers:{"Content-Type":"application/json"}};return e.token&&(f.headers.Authorization="token "+e.token),e.email&&e.password&&(f.headers.Authorization="Basic "+new Buffer(e.email+":"+e.password).toString("base64")),t.create=n,t.list=u,t.listStream=l,t.purge=d,t}},function(e,t){t=e.exports=function(e,t){if(!t||"object"!=typeof t)return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}},function(e,t,n){function r(e,t){var n=Array.prototype.slice.call(arguments,2);return function(){var r=n.concat(Array.prototype.slice.call(arguments));return t.apply(e,r)}}function i(e,t,n,i){"object"==typeof e&&(n=t,t=e,e=void 0),"function"==typeof t&&(n=t,t=void 0),t||(t={}),void 0!==e&&(t.uri=e),i&&(t.method=i.method);var a=new o(t),s=a.duplex&&c();s&&s.pause();var u=c(),d=a.duplex?l(s,u):u;a.duplex||(u.writable=!1),d.request=a,d.setHeader=r(a,a.setHeader),d.setLocation=r(a,a.setLocation);var f=!1;return d.on("close",function(){f=!0}),process.nextTick(function(){if(!f){d.on("close",function(){e.destroy()});var e=a._send();e.on("error",r(d,d.emit,"error")),e.on("response",function(e){d.response=e,d.emit("response",e),a.duplex?e.pipe(u):(e.on("data",function(e){u.queue(e)}),e.on("end",function(){u.queue(null)}))}),a.duplex?(s.pipe(e),s.resume()):e.end()}}),n&&(d.on("error",n),d.on("response",r(d,n,null))),d}function o(e){this.headers=e.headers||{};var t=(e.method||"GET").toUpperCase();this.method=t,this.duplex=!("GET"===t||"DELETE"===t||"HEAD"===t),this.auth=e.auth,this.options=e,e.uri&&this.setLocation(e.uri)}var a=n(18),s=n(16),u=n(17),c=n(26),l=n(25);e.exports=i,i.get=i,i.post=function(e,t,n){return i(e,t,n,{method:"POST"})},i.put=function(e,t,n){return i(e,t,n,{method:"PUT"})},i.delete=function(e,t,n){return i(e,t,n,{method:"DELETE"})},o.prototype._send=function(){this._sent=!0;var e=this.headers||{},t=a.parse(this.uri),n=t.auth||this.auth;n&&(e.authorization="Basic "+Buffer(n).toString("base64"));var r=t.protocol||"",i="https:"===r?u:s,o={scheme:r.replace(/:$/,""),method:this.method,host:t.hostname,port:Number(t.port)||("https:"===r?443:80),path:t.path,agent:!1,headers:e,withCredentials:this.options.withCredentials};"https:"===r&&(o.pfx=this.options.pfx,o.key=this.options.key,o.cert=this.options.cert,o.ca=this.options.ca,o.ciphers=this.options.ciphers,o.rejectUnauthorized=this.options.rejectUnauthorized,o.secureProtocol=this.options.secureProtocol);var c=i.request(o);return c.setTimeout&&c.setTimeout(1e3*Math.pow(2,32)),c},o.prototype.setHeader=function(e,t){if(this._sent)throw new Error("request already sent");return this.headers[e]=t,this},o.prototype.setLocation=function(e){return this.uri=e,this}},function(e,t,n){function r(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n)}function i(e,t){function n(t){function n(){return e[t].apply(e,arguments)}h[t]=n}function i(e){function n(){h.emit(e);var n=t[e];return n?n.apply(t,arguments):void t.emit(e)}h[e]=n}function l(e){function n(){var t=c.call(arguments);t.unshift(e),h.emit.apply(h,t)}t.on(e,n)}function d(){if(!p){p=!0;var e=c.call(arguments);e.unshift("end"),h.emit.apply(h,e)}}function f(e){h.emit("error",e)}var h=new o,p=!1;return r(a,n),r(s,i),r(u,l),t.on("end",d),e.on("drain",function(){h.emit("drain")}),e.on("error",f),t.on("error",f),h.writable=e.writable,h.readable=t.readable,h}var o=n(1),a=["write","end","destroy"],s=["resume","pause"],u=["data","close"],c=Array.prototype.slice;e.exports=i},function(e,t,n){function r(e,t){function n(){for(;s.length&&!u.paused;){var e=s.shift();if(null===e)return u.emit("end");u.emit("data",e)}}function r(){u.writable=!1,t.call(u),u.readable||u.destroy()}e=e||function(e){this.queue(e)},t=t||function(){this.queue(null)};var o=!1,a=!1,s=[],u=new i;return u.readable=u.writable=!0,u.paused=!1,u.write=function(t){return e.call(this,t),!u.paused},u.queue=u.push=function(e){return s.push(e),n(),u},u.on("end",function(){u.readable=!1,u.writable||process.nextTick(function(){u.destroy()})}),u.end=function(e){return o?void 0:(o=!0,arguments.length&&u.write(e),r(),u)},u.destroy=function(){return a?void 0:(a=!0,o=!0,s.length=0,u.writable=u.readable=!1,u.emit("close"),u)},u.pause=function(){return u.paused?void 0:(u.paused=!0,u.emit("pause"),u)},u.resume=function(){return u.paused&&(u.paused=!1),n(),u.paused||u.emit("drain"),u},u}var i=n(1);t=e.exports=r,r.through=r},function(e,t){e.exports=function(e,t){var n=!1,r=[];e.on("data",function(e){r.push(e)}),e.on("end",function(){if(!n){n=!0;var i;try{i=Buffer.concat(r)}catch(o){e._readableState?(("utf8"===e._readableState.encoding||"ascii"===e._readableState.encoding)&&(i=r.join("")),e._readableState.objectMode&&(i=r)):i=r.join("")}t(null,i),r.length=0}}),e.on("error",function(e){n=!0,r=null,t(e)})}},function(e,t,n){t.server={url:"https://api.crowdprocess.com:443"}},function(e,t,n){function r(e,t,n){return function(r){function u(){var e=d.response.statusCode;if(200!==e&&0!==e){var t=new Error("Unexpected status code: "+e);throw t.status=e,t}}r||(r={});var c=n.baseUrl+encodeURIComponent(e)+"/errors?"+a.stringify(r),l=i({uri:c},t),d=o(l);d.on("response",u);var f=new s.Parser;return d.pipe(f),f.on("end",function(){d.end()}),f}}var i=(n(1).Transform,n(2)._extend),o=n(6),a=n(9),s=n(7);e.exports=r},function(e,t,n){function r(e){var t={headers:{"Content-Type":"application/json"}};return e||(e={}),e.token&&(t.headers.Authorization="token "+e.token),e.email&&e.password&&(t.headers.Authorization="Basic "+new Buffer(e.email+":"+e.password).toString("base64")),e.baseUrl=(e.url||i.server.url)+"/jobs/",function(n){return{Tasks:o(n,t,e),Results:a(n,t,e),Errors:s(n,t,e)}}}var i=n(28),o=n(36),a=n(35),s=n(29);e.exports=r},function(e,t,n){function r(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n)}function i(e,t){function n(t){function n(){return e[t].apply(e,arguments)}h[t]=n}function i(e){function n(){h.emit(e);var n=t[e];return n?n.apply(t,arguments):void t.emit(e)}h[e]=n}function l(e){function n(){var t=c.call(arguments);t.unshift(e),h.emit.apply(h,t)}t.on(e,n)}function d(){if(!p){p=!0;var e=c.call(arguments);e.unshift("end"),h.emit.apply(h,e)}}function f(e){h.emit("error",e)}var h=new o,p=!1;return r(a,n),r(s,i),r(u,l),t.on("end",d),e.on("drain",function(){h.emit("drain")}),e.on("error",f),t.on("error",f),h.writable=e.writable,h.readable=t.readable,h}var o=n(1),a=["write","end","destroy"],s=["resume","pause"],u=["data","close"],c=Array.prototype.slice;e.exports=i},function(e,t,n){function r(e,t){function n(){for(;s.length&&!u.paused;){var e=s.shift();if(null===e)return u.emit("end");u.emit("data",e)}}function r(){u.writable=!1,t.call(u),u.readable||u.destroy()}e=e||function(e){this.queue(e)},t=t||function(){this.queue(null)};var o=!1,a=!1,s=[],u=new i;return u.readable=u.writable=!0,u.paused=!1,u.write=function(t){return e.call(this,t),!u.paused},u.queue=u.push=function(e){return s.push(e),n(),u},u.on("end",function(){u.readable=!1,u.writable||process.nextTick(function(){u.destroy()})}),u.end=function(e){return o?void 0:(o=!0,arguments.length&&u.write(e),r(),u)},u.destroy=function(){return a?void 0:(a=!0,o=!0,s.length=0,u.writable=u.readable=!1,u.emit("close"),u)},u.pause=function(){return u.paused?void 0:(u.paused=!0,u.emit("pause"),u)},u.resume=function(){return u.paused&&(u.paused=!1),n(),u.paused||u.emit("drain"),u},u}var i=n(1);t=e.exports=r,r.through=r},function(e,t,n){function r(e){return this instanceof r?(a.call(this,e),this._writableState.objectMode=!1,this._readableState.objectMode=!0,this._buffer="",void(this._decoder=new o("utf8"))):new r(e)}var i=n(2),o=n(41).StringDecoder,a=n(1).Transform;i.inherits(r,a),r.prototype._transform=function(e,t,n){this._buffer+=this._decoder.write(e);var r=this._buffer.split(/\r?\n/);this._buffer=r.pop();for(var i=0;i<r.length;i++){var o=r[i];try{var a=JSON.parse(o);this.push(null===a||void 0===a?!1:a)}catch(s){var u=r.slice(i).join("\n")+"\n"+this._buffer;return er=new Error(s.message+" in "+JSON.stringify(u)),void this.emit("error",er)}}n()},r.prototype._flush=function(e){var t=this._buffer.trim();if(t)try{var n=JSON.parse(t);this.push(n)}catch(r){return void this.emit("error",r)}e()},e.exports=r},function(e,t,n){function r(e){return e||(e={}),this instanceof r?(o.call(this,e),this._writableState.objectMode=!0,void(this._readableState.objectMode=!1)):new r(e)}var i=n(2),o=n(1).Transform;i.inherits(r,o),r.prototype._transform=function(e,t,n){this.push(JSON.stringify(e)+"\n"),n()},e.exports=r},function(e,t,n){function r(e,t,n){return function(r){function u(){var e=d.response.statusCode;if(200!==e&&0!==e){var t=new Error("Unexpected status code: "+e);throw t.status=e,t}}r||(r={});var c=n.baseUrl+encodeURIComponent(e)+"/results?"+a.stringify(r),l=i({uri:c},t),d=o(l);d.on("response",u);var f=new s.Parser;return d.pipe(f),f.on("end",function(){d.end()}),f}}var i=(n(1).Transform,n(2)._extend),o=n(6),a=n(9),s=n(7);e.exports=r},function(e,t,n){function r(e,t,n){return function(){function r(){var e=u.response.statusCode;if(201!==e&&0!==e){var t=new Error("Unexpected status code: "+e);throw t.status=e,t}}var s=i({uri:n.baseUrl+encodeURIComponent(e)+"/tasks"},t),u=o.post(s);u.on("response",r);var c=new a.Stringifier;return c.pipe(u),c}}var i=(n(1).Transform,n(2)._extend),o=n(6),a=(n(9),n(7));e.exports=r},function(e,t,n){function r(e){return this instanceof r?void i.call(this,e):new r(e)}e.exports=r;var i=n(12),o=n(4);o.inherits=n(5),o.inherits(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t){e.exports="/**\n * DecisionTree\n * ============\n *\n *\n */\n\n/**\n * represents a single decision tree\n */\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar DecisionTree = (function () {\n\n  /**\n   * [constructor description]\n   *\n   * @param  {[type]} serial [description]\n   * @return {[type]}        [description]\n   */\n\n  function DecisionTree() {\n    var serial = arguments[0] === undefined ? {} : arguments[0];\n\n    _classCallCheck(this, DecisionTree);\n\n    if (typeof serial === 'string') {\n      serial = JSON.parse(serial);\n    }\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n      for (var _iterator = Object.keys(serial)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        var key = _step.value;\n\n        this[key] = serial[key];\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator['return']) {\n          _iterator['return']();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n\n    if (!this.trainFun) {\n      this.trainFun = this.weakType === 0 ? decisionStumpTrain : decision2DStumpTrain;\n    }\n    if (!this.testFun) {\n      this.testFun = this.weakType === 0 ? decisionStumpTest : decision2DStumpTest;\n    }\n  }\n\n  _createClass(DecisionTree, [{\n    key: 'train',\n\n    /**\n     * [train description]\n     *\n     * @param  {Array}   data    -\n     * @param  {Array}   labels  -\n     * @param  {Object]} options -\n     */\n    value: function train(data, labels) {\n      var options = arguments[2] === undefined ? {} : arguments[2];\n\n      var maxDepth = options.maxDepth || 4;\n      var weakType = options.type || 0;\n\n      var trainFun = options.trainFun || decision2DStumpTrain;\n      var testFun = options.testFun || decision2DStumpTest;\n\n      if (weakType == 0) {\n        trainFun = decisionStumpTrain;\n        testFun = decisionStumpTest;\n      }\n      if (weakType == 1) {\n        trainFun = decision2DStumpTrain;\n        testFun = decision2DStumpTest;\n      }\n\n      // initialize various helper variables\n      var numInternals = Math.pow(2, maxDepth) - 1;\n      var numNodes = Math.pow(2, maxDepth + 1) - 1;\n      var ixs = new Array(numNodes); // 31 -> 2^5 -1\n      // console.log(numNodes, maxDepth);\n      // debugger\n      for (var i = 1; i < ixs.length; i++) {\n        ixs[i] = [];\n      }\n      ixs[0] = new Array(labels.length);\n      for (var i = 0; i < labels.length; i++) {\n        ixs[0][i] = i; // root node starts out with all nodes as relevant\n      }\n      var models = new Array(numInternals);\n\n      // train\n      for (var n = 0; n < numInternals; n++) {\n\n        // few base cases\n        var ixhere = ixs[n];\n        if (ixhere.length == 0) {\n          continue;\n        }\n        if (ixhere.length == 1) {\n          ixs[n * 2 + 1] = [ixhere[0]];\n          continue;\n        } // arbitrary send it down left\n\n        // learn a weak model on relevant data for this node\n        var model = trainFun(data, labels, ixhere);\n\n        models[n] = model; // back it up model\n\n        // split the data according to the learned model\n        var ixleft = [];\n        var ixright = [];\n\n        for (var i = 0; i < ixhere.length; i++) {\n          var label = testFun(data[ixhere[i]], model);\n          if (label === 1) {\n            ixleft.push(ixhere[i]);\n          } else {\n            ixright.push(ixhere[i]);\n          }\n        }\n        ixs[n * 2 + 1] = ixleft;\n        ixs[n * 2 + 2] = ixright;\n      }\n\n      // compute data distributions at the leafs\n      var leafPositives = new Array(numNodes);\n      var leafNegatives = new Array(numNodes);\n      for (var n = numInternals; n < numNodes; n++) {\n        var numones = 0;\n        for (var i = 0; i < ixs[n].length; i++) {\n          if (labels[ixs[n][i]] === 1) {\n            numones += 1;\n          }\n        }\n        leafPositives[n] = numones;\n        leafNegatives[n] = ixs[n].length - numones;\n      }\n\n      // back up important prediction variables for predicting later\n      this.models = models;\n      this.leafPositives = leafPositives;\n      this.leafNegatives = leafNegatives;\n      this.maxDepth = maxDepth;\n      this.weakType = weakType;\n      this.trainFun = trainFun;\n      this.testFun = testFun;\n    }\n  }, {\n    key: 'predictOne',\n\n    /**\n     * [predictOne description]\n     * returns probability that example inst is 1.\n     *\n     * @param  {Array}  inst -\n     * @return {Number}\n     */\n    value: function predictOne(inst) {\n      var n = 0;\n      for (var i = 0; i < this.maxDepth; i++) {\n        var dir = this.testFun(inst, this.models[n]);\n        if (dir === 1) {\n          n = n * 2 + 1; // descend left\n        } else {\n          n = n * 2 + 2; // descend right\n        }\n      }\n      return (this.leafPositives[n] + 0.5) / (this.leafNegatives[n] + 1.0); // bayesian smoothing!\n    }\n  }]);\n\n  return DecisionTree;\n})();\n\nexports['default'] = DecisionTree;\n\n/**\n * [decisionStumpTrain description]\n * returns model\n *\n * @param  {Array}  data    -\n * @param  {Array}  labels  -\n * @param  {Array}  ix      -\n * @param  {Object} options -\n * @return {Object}\n */\nfunction decisionStumpTrain(data, labels, ix) {\n  var options = arguments[3] === undefined ? {} : arguments[3];\n\n  var numtries = options.numTries || 10;\n\n  // choose a dimension at random and pick a best split\n  var ri = randi(0, data[0].length);\n  var N = ix.length;\n\n  // evaluate class entropy of incoming data\n  var H = entropy(labels, ix);\n  var bestGain = 0;\n  var bestThr = 0;\n  for (var i = 0; i < numtries; i++) {\n\n    // pick a random splitting threshold\n    var ix1 = ix[randi(0, N)];\n    var ix2 = ix[randi(0, N)];\n    while (ix2 == ix1) {\n      ix2 = ix[randi(0, N)]; // enforce distinctness of ix2\n    }\n\n    var a = Math.random();\n    var thr = data[ix1][ri] * a + data[ix2][ri] * (1 - a);\n\n    // measure information gain we'd get from split with thr\n    var l1 = 1,\n        r1 = 1,\n        lm1 = 1,\n        rm1 = 1; //counts for Left and label 1, right and label 1, left and minus 1, right and minus 1\n    for (var j = 0; j < ix.length; j++) {\n      if (data[ix[j]][ri] < thr) {\n        if (labels[ix[j]] == 1) {\n          l1++;\n        } else {\n          lm1++;\n        }\n      } else {\n        if (labels[ix[j]] == 1) {\n          r1++;\n        } else {\n          rm1++;\n        }\n      }\n    }\n\n    var t = l1 + lm1; // normalize the counts to obtain probability estimates\n    l1 = l1 / t;\n    lm1 = lm1 / t;\n    t = r1 + rm1;\n    r1 = r1 / t;\n    rm1 = rm1 / t;\n\n    var LH = -l1 * Math.log(l1) - lm1 * Math.log(lm1); // left and right entropy\n    var RH = -r1 * Math.log(r1) - rm1 * Math.log(rm1);\n\n    var informationGain = H - LH - RH;\n    //console.log(\"Considering split %f, entropy %f -> %f, %f. Gain %f\", thr, H, LH, RH, informationGain);\n    if (informationGain > bestGain || i === 0) {\n      bestGain = informationGain;\n      bestThr = thr;\n    }\n  }\n\n  return { // model\n    ri: ri,\n    thr: bestThr\n  };\n}\n\n/**\n * [decisionStumpTest description]\n * returns a decision for a single data instance\n *\n * @param  {Arrat}  inst  -\n * @param  {Object} model -\n * @return {Number}\n */\nfunction decisionStumpTest(inst, model) {\n  if (!model) {\n    // this is a leaf that never received any data...\n    return 1;\n  }\n  return inst[model.ri] < model.thr ? 1 : -1;\n}\n\n/**\n * [decision2DStumpTrain description]\n * returns model. Code duplication with decisionStumpTrain :(\n *\n * @param  {Array} data     -\n * @param  {Array} labels   -\n * @param  {Array} ix       -\n * @param  {Object} options -\n * @return {Object}         - model\n */\nfunction decision2DStumpTrain(data, labels, ix) {\n  var options = arguments[3] === undefined ? {} : arguments[3];\n\n  var numtries = options.numTries || 10;\n\n  // choose a dimension at random and pick a best split\n  var N = ix.length;\n\n  var ri1 = 0;\n  var ri2 = 1;\n\n  if (data[0].length > 2) {\n    // more than 2D data. Pick 2 random dimensions\n    ri1 = randi(0, data[0].length);\n    ri2 = randi(0, data[0].length);\n    while (ri2 == ri1) {\n      ri2 = randi(0, data[0].length); // must be distinct!\n    }\n  }\n\n  // evaluate class entropy of incoming data\n  var H = entropy(labels, ix);\n  var bestGain = 0;\n  var bestw1, bestw2, bestthr;\n  var dots = new Array(ix.length);\n\n  for (var i = 0; i < numtries; i++) {\n\n    // pick random line parameters\n    var alpha = randf(0, 2 * Math.PI);\n    var w1 = Math.cos(alpha);\n    var w2 = Math.sin(alpha);\n\n    // project data on this line and get the dot products\n    for (var j = 0; j < ix.length; j++) {\n      dots[j] = w1 * data[ix[j]][ri1] + w2 * data[ix[j]][ri2];\n    }\n\n    // we are in a tricky situation because data dot product distribution\n    // can be skewed. So we don't want to select just randomly between\n    // min and max. But we also don't want to sort as that is too expensive\n    // let's pick two random points and make the threshold be somewhere between them.\n    // for skewed datasets, the selected points will with relatively high likelihood\n    // be in the high-desnity regions, so the thresholds will make sense\n    var ix1 = ix[randi(0, N)];\n    var ix2 = ix[randi(0, N)];\n    while (ix2 == ix1) {\n      ix2 = ix[randi(0, N)]; // enforce distinctness of ix2\n    }\n    var a = Math.random();\n    var dotthr = dots[ix1] * a + dots[ix2] * (1 - a);\n\n    // measure information gain we'd get from split with thr\n    var l1 = 1,\n        r1 = 1,\n        lm1 = 1,\n        rm1 = 1; //counts for Left and label 1, right and label 1, left and minus 1, right and minus 1\n    for (var j = 0; j < ix.length; j++) {\n      if (dots[j] < dotthr) {\n        if (labels[ix[j]] == 1) {\n          l1++;\n        } else {\n          lm1++;\n        }\n      } else {\n        if (labels[ix[j]] == 1) {\n          r1++;\n        } else {\n          rm1++;\n        }\n      }\n    }\n    var t = l1 + lm1;\n    l1 = l1 / t;\n    lm1 = lm1 / t;\n    t = r1 + rm1;\n    r1 = r1 / t;\n    rm1 = rm1 / t;\n\n    var LH = -l1 * Math.log(l1) - lm1 * Math.log(lm1); // left and right entropy\n    var RH = -r1 * Math.log(r1) - rm1 * Math.log(rm1);\n\n    var informationGain = H - LH - RH;\n    //console.log(\"Considering split %f, entropy %f -> %f, %f. Gain %f\", thr, H, LH, RH, informationGain);\n    if (informationGain > bestGain || i === 0) {\n      bestGain = informationGain;\n      bestw1 = w1;\n      bestw2 = w2;\n      bestthr = dotthr;\n    }\n  }\n\n  return { // model\n    w1: bestw1,\n    w2: bestw2,\n    dotthr: bestthr\n  };\n}\n\n/**\n * [decision2DStumpTest description]\n * returns label for a single data instance\n *\n * @param  {Array}  inst  -\n * @param  {Object} model -\n * @return {Number}\n */\nfunction decision2DStumpTest(inst, model) {\n  if (!model) {\n    // this is a leaf that never received any data...\n    return 1;\n  }\n  return inst[0] * model.w1 + inst[1] * model.w2 < model.dotthr ? 1 : -1;\n}\n\n/**\n * [entropy description]\n * Misc utility functions\n *\n * @param  {String} labels -\n * @param  {Array}  ix     -\n * @return {Number}\n */\nfunction entropy(labels, ix) {\n  var N = ix.length;\n  var p = 0;\n  for (var i = 0; i < N; i++) {\n    if (labels[ix[i]] == 1) {\n      p += 1;\n    }\n  }\n  p = (1 + p) / (N + 2); // let's be bayesian about this\n  var q = (1 + N - p) / (N + 2);\n  return -p * Math.log(p) - q * Math.log(q);\n}\n\n/**\n * [randf description]\n * generate random floating point number between a and b\n *\n * @param  {Number} a -\n * @param  {Number} b -\n * @return {Number}\n */\nfunction randf(a, b) {\n  return Math.random() * (b - a) + a;\n}\n\n/**\n * [randi description]\n * generate random integer between a and b (b excluded)\n *\n * @param  {Number} a -\n * @param  {Number} b -\n * @return {Number}\n */\nfunction randi(a, b) {\n  return Math.floor(Math.random() * (b - a) + a);\n}\nmodule.exports = exports['default'];"},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("string_decoder")}])});